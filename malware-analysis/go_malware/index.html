<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="turbo-root" content="/retype">
    <meta name="turbo-cache-control" content="no-cache" data-turbo-track="reload" data-track-token="3.12.0.824223940090">

    <!-- See retype.com -->
    <meta name="generator" content="Retype 3.12.0">

    <!-- Primary Meta Tags -->
    <title>Analyzing A GO Malware</title>
    <meta name="title" content="Analyzing A GO Malware">
    <meta name="description" content="Hello Friends, This post covers my analysis of a Linux-based Go malware sample.">

    <!-- Canonical -->
    <link rel="canonical" href="https://nxb1t.github.io/retype/malware-analysis/go_malware/">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://nxb1t.github.io/retype/malware-analysis/go_malware/">
    <meta property="og:title" content="Analyzing A GO Malware">
    <meta property="og:description" content="Hello Friends, This post covers my analysis of a Linux-based Go malware sample.">
    <meta property="og:image" content="https://nxb1t.github.io/retype/assets/img/go_malware/cover.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://nxb1t.github.io/retype/malware-analysis/go_malware/">
    <meta property="twitter:title" content="Analyzing A GO Malware">
    <meta property="twitter:description" content="Hello Friends, This post covers my analysis of a Linux-based Go malware sample.">
    <meta property="twitter:image" content="https://nxb1t.github.io/retype/assets/img/go_malware/cover.png">

    <script data-cfasync="false">(function(){var cl=document.documentElement.classList,ls=localStorage.getItem("retype_scheme"),hd=cl.contains("dark"),hl=cl.contains("light"),wm=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;if(ls==="dark"||(!ls&&wm&&!hd&&!hl)){cl.remove("light");cl.add("dark")}else if(ls==="light"||(!ls&&!wm&&!hd&&!hl)){cl.remove("dark");cl.add("light")}})();</script>

    <link id="retype-favicon" rel="icon" href="../../assets/img/favicon.ico" />
    <link href="../../resources/css/retype.css?v=3.12.0.824223940090" rel="stylesheet">

    <script data-cfasync="false" src="../../resources/js/config.js?v=3.12.0.824223940090" data-turbo-eval="false" defer></script>
    <script data-cfasync="false" src="../../resources/js/retype.js?v=3.12.0" data-turbo-eval="false" defer></script>
    <script id="lunr-js" data-cfasync="false" src="../../resources/js/lunr.js?v=3.12.0.824223940090" data-turbo-eval="false" defer></script>
    <script id="prism-js" data-cfasync="false" src="../../resources/js/prism.js?v=3.12.0.824223940090" defer></script>
</head>
<body>
    <div id="retype-app" class="relative text-base antialiased text-base-text bg-base-bg font-body">
        <div class="absolute bottom-0 left-0" style="top: 5rem; right: 50%"></div>
    
        <header id="retype-header" class="sticky top-0 z-30 flex w-full h-16 bg-header-bg border-b border-header-border md:h-20">
            <div class="container relative flex items-center justify-between pr-6 grow md:justify-start">
                <!-- Mobile menu button skeleton -->
                <button v-cloak class="skeleton retype-mobile-menu-button flex items-center justify-center shrink-0 overflow-hidden dark:text-white focus:outline-none rounded-full w-10 h-10 ml-3.5 md:hidden"><svg xmlns="http://www.w3.org/2000/svg" class="mb-px shrink-0" width="24" height="24" viewBox="0 0 24 24" role="presentation" style="margin-bottom: 0px;"><g fill="currentColor"><path d="M2 4h20v2H2zM2 11h20v2H2zM2 18h20v2H2z"></path></g></svg></button>
                <div v-cloak id="retype-sidebar-left-toggle-button"></div>
        
                <!-- Logo -->
                <div class="flex items-center justify-between h-full py-2 md:w-75">
                    <div class="flex items-center px-2 md:px-6">
                        <a id="retype-branding-logo" href="../../" class="flex items-center leading-snug text-2xl">
                            <span class="dark:text-white font-bold line-clamp-1 md:line-clamp-2">nxb1t</span>
                        </a><span id="retype-branding-label" class="inline-flex mt-1 px-2 py-1 ml-4 text-xs font-medium leading-none items-center rounded-md bg-branding-label-bg text-branding-label-text ring-1 ring-branding-label-border ring-inset md:inline-block">is-a.dev</span>
                    </div>
        
                    <span class="hidden h-8 border-r md:inline-block border-base-border"></span>
                </div>
        
                <div class="flex justify-between md:grow">
                    <!-- Top Nav -->
                    <nav id="retype-header-nav" class="hidden md:flex">
                        <ul class="flex flex-col mb-4 md:pl-16 md:mb-0 md:flex-row md:items-center">
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://nxb1t.neocities.org" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M8.75 7a.75.75 0 0 0 0 1.5h7.5a.75.75 0 0 0 0-1.5h-7.5ZM7 11.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75ZM9.75 15a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z"></path><path d="M2 3.75C2 2.784 2.784 2 3.75 2h16.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 20.25 22H3.75A1.75 1.75 0 0 1 2 20.25Zm1.75-.25a.25.25 0 0 0-.25.25v16.5c0 .138.112.25.25.25h16.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z"></path>
                                        </g>
                                    </svg>
                                    <span>CTF Writeups</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://github.com/nxb1t" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                                        </g>
                                    </svg>
                                    <span>GitHub</span>
                                </a>
                            </li>
                            <li class="mr-6">
                                <a class="py-2 md:mb-0 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://www.linkedin.com/in/nashid-p-694842226" target="_blank">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                        <g fill="currentColor">
                                            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                                        </g>
                                    </svg>
                                    <span>LinkedIn</span>
                                </a>
                            </li>
        
                        </ul>
                    </nav>
        
                    <div v-cloak class="flex justify-end grow">
                        <div id="retype-mobile-search-button"></div>
                        <doc-search-desktop></doc-search-desktop>
        
                        <doc-theme-switch class="lg:ml-2"></doc-theme-switch>
                        <doc-history></doc-history>
                    </div>
                </div>
            </div>
        </header>
    
    
        <div id="retype-container" class="container relative flex bg-white">
            <!-- Sidebar Skeleton -->
            <div v-cloak class="fixed flex flex-col shrink-0 duration-300 ease-in-out bg-sidebar-left-bg border-sidebar-left-border sidebar top-20 w-75 border-r h-screen md:sticky transition-transform skeleton">
            
                <div class="flex items-center h-16 px-6">
                    <input id="retype-filter-input-mock" class="w-full h-10 pl-8 px-3 py-2 transition-colors duration-200 ease-linear bg-filter-bg border border-filter-border rounded-lg shadow-none md:text-sm hover:border-filter-border-hover focus:outline-none focus:border-filter-border-focus placeholder-filter-placeholder" type="text">
                </div>
            
                <div class="pl-6 mt-1 mb-4">
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                    <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                </div>
            
                <div class="shrink-0 mt-auto bg-transparent dark:border-base-border">
                    <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                        <span class="text-xs whitespace-nowrap">Powered by</span>
                        <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                    </a>
                </div>
            </div>
            
            <!-- Sidebar component -->
            <doc-sidebar v-cloak>
                <template #sidebar-footer>
                    <div class="shrink-0 mt-auto border-t md:bg-transparent md:border-none dark:border-base-border">
            
                        <div class="py-3 px-6 md:hidden border-b dark:border-base-border">
                            <nav>
                                <ul class="flex flex-wrap justify-center items-center">
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://nxb1t.neocities.org" target="_blank">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M8.75 7a.75.75 0 0 0 0 1.5h7.5a.75.75 0 0 0 0-1.5h-7.5ZM7 11.75a.75.75 0 0 1 .75-.75h6.5a.75.75 0 0 1 0 1.5h-6.5a.75.75 0 0 1-.75-.75ZM9.75 15a.75.75 0 0 0 0 1.5h6.5a.75.75 0 0 0 0-1.5h-6.5Z"></path><path d="M2 3.75C2 2.784 2.784 2 3.75 2h16.5c.966 0 1.75.784 1.75 1.75v16.5A1.75 1.75 0 0 1 20.25 22H3.75A1.75 1.75 0 0 1 2 20.25Zm1.75-.25a.25.25 0 0 0-.25.25v16.5c0 .138.112.25.25.25h16.5a.25.25 0 0 0 .25-.25V3.75a.25.25 0 0 0-.25-.25Z"></path>
                                                </g>
                                            </svg>
                                            <span>CTF Writeups</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://github.com/nxb1t" target="_blank">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                                                </g>
                                            </svg>
                                            <span>GitHub</span>
                                        </a>
                                    </li>
                                    <li class="mr-6">
                                        <a class="block py-1 inline-flex items-center text-sm whitespace-nowrap transition-colors duration-200 ease-linear md:text-header-text font-header-text hover:text-header-text-hover" href="https://www.linkedin.com/in/nashid-p-694842226" target="_blank">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px mr-1" width="18" height="18" viewBox="0 0 24 24" role="presentation">
                                                <g fill="currentColor">
                                                    <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
                                                </g>
                                            </svg>
                                            <span>LinkedIn</span>
                                        </a>
                                    </li>
            
                                </ul>
                            </nav>
                        </div>
            
                        <a class="flex items-center justify-center flex-nowrap h-16 text-gray-350 dark:text-dark-400 hover:text-gray-600 dark:hover:text-dark-300 transition-colors duration-150 ease-in docs-powered-by" target="_blank" href="https://retype.com/" rel="noopener">
                            <span class="text-xs whitespace-nowrap">Powered by</span>
                            <svg xmlns="http://www.w3.org/2000/svg" class="ml-2" fill="currentColor" width="96" height="20" overflow="visible"><path d="M0 0v20h13.59V0H0zm11.15 17.54H2.44V2.46h8.71v15.08zM15.8 20h2.44V4.67L15.8 2.22zM20.45 6.89V20h2.44V9.34z"/><g><path d="M40.16 8.44c0 1.49-.59 2.45-1.75 2.88l2.34 3.32h-2.53l-2.04-2.96h-1.43v2.96h-2.06V5.36h3.5c1.43 0 2.46.24 3.07.73s.9 1.27.9 2.35zm-2.48 1.1c.26-.23.38-.59.38-1.09 0-.5-.13-.84-.4-1.03s-.73-.28-1.39-.28h-1.54v2.75h1.5c.72 0 1.2-.12 1.45-.35zM51.56 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92h4.74v1.83h-6.79V5.36h6.64zM60.09 7.15v7.48h-2.06V7.15h-2.61V5.36h7.28v1.79h-2.61zM70.81 14.64h-2.06v-3.66l-3.19-5.61h2.23l1.99 3.45 1.99-3.45H74l-3.19 5.61v3.66zM83.99 6.19c.65.55.97 1.4.97 2.55s-.33 1.98-1 2.51-1.68.8-3.04.8h-1.23v2.59h-2.06V5.36h3.26c1.42 0 2.45.28 3.1.83zm-1.51 3.65c.25-.28.37-.69.37-1.22s-.16-.92-.48-1.14c-.32-.23-.82-.34-1.5-.34H79.7v3.12h1.38c.68 0 1.15-.14 1.4-.42zM95.85 5.36V7.2h-4.59v1.91h4.13v1.76h-4.13v1.92H96v1.83h-6.79V5.36h6.64z"/></g></svg>
                        </a>
                    </div>
                </template>
            </doc-sidebar>
    
            <div class="grow min-w-0 bg-body-bg">
                <!-- Render "toolbar" template here on api pages --><!-- Render page content -->
                <div class="flex">
                    <div id="retype-main" class="min-w-0 p-4 grow md:px-16">
                        <main class="relative pb-12 lg:pt-2">
                            <div class="retype-markdown" id="retype-content">
                                <!-- Rendered if sidebar right is enabled -->
                                <div id="retype-sidebar-right-toggle"></div>
                                <nav id="retype-breadcrumb" class="breadcrumb" aria-label="Breadcrumb">
                                    <ol role="list">
                                        <li class="pr-4">
                                            <a href="../../" class="pr-4">
                                                Home
                                            </a>
                                            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" width="18" height="18" viewBox="0 0 24 24" aria-hidden="true">
                                                <path d="M8.72 18.78a.75.75 0 0 1 0-1.06L14.44 12 8.72 6.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018l6.25 6.25a.75.75 0 0 1 0 1.06l-6.25 6.25a.75.75 0 0 1-1.06 0Z"/>
                                            </svg>
                                        </li>
                                        <li class="pr-4">
                                            <span class="pr-4">
                                                Malware Analysis
                                            </span>
                                        </li>
                                    </ol>
                                </nav>
                
                                <!-- Page content  -->
<doc-anchor-target id="analyzing-a-go-malware" class="break-words">
    <h1>
        <doc-anchor-trigger class="header-anchor-trigger" to="#analyzing-a-go-malware">#</doc-anchor-trigger>
        <span>Analyzing A GO Malware</span>
    </h1>
</doc-anchor-target>
<div class="-mt-3 mb-12 flex flex-wrap text-sm text-gray-400 dark:text-dark-350 items-center">
    <div class="flex items-center">
        <div>By</div>
        <div class="ml-2 flex items-center">
          <div class="shrink-0 w-8 h-8 overflow-hidden rounded-full">
            <img class="object-cover" src="https://nxb1t.is-a.dev/assets/img/profile.jpeg">
          </div>
          <div class="ml-1 whitespace-nowrap text-gray-500 dark:text-dark-350">nxb1t</div>
        </div>
    </div>
    <div class="mx-2">&#9679;</div>
    <div>In&nbsp;</div>
    <div><a href="../../categories/malware-analysis/">Malware Analysis</a>,&nbsp;</div>
    <div><a href="../../categories/reverse-engineering/">Reverse Engineering</a></div>
    <div class="mx-2">&#9679;</div>
    <div class="flex items-center shrink-0">Published&nbsp;<span>2025-09-20</span></div>
</div>

<p><figure class="content-center">
    <img src="../../assets/img/go_malware/cover.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Hello Friends, <br>
This post covers my analysis of a Linux-based Go malware sample. It used anti-VM evasion techniques, which made it harder for sandbox environments to detect. Reverse engineering this sample was really interesting, especially the C2 agent and data exfiltration parts, which operated in unexpected ways.</p>
<doc-anchor-target id="overview">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#overview">#</doc-anchor-trigger>
        <span>Overview</span>
    </h2>
</doc-anchor-target>
<hr>
<p>The sample analyzed was a multi-stage Go-based loader designed to fetch, decrypt, and execute multiple payloads. Its modular structure allowed each stage to handle a specific responsibility, gradually building toward full system compromise and data exfiltration.</p>
<ul>
<li><p>Stage 1 – Initial Loader<br>
The first stage downloads two components: <code translate="no" v-pre>access</code> and <code translate="no" v-pre>inter_ddns</code>. The access binary is responsible for decrypting inter_ddns, enabling the next execution phase.</p>
</li>
<li><p>Stage 2 – Core Loader (inter_ddns)<br>
Once decrypted, inter_ddns operates as the core loader. It retrieves four additional binaries — <code translate="no" v-pre>access2</code>, <code translate="no" v-pre>server2</code>, <code translate="no" v-pre>access3</code>, and <code translate="no" v-pre>drive</code> — and executes them sequentially.</p>
</li>
<li><p>Stage 3 – Command &amp; Control<br>
The server2 binary establishes communication with the Command-and-Control (C2) server, enabling remote access control.</p>
</li>
<li><p>Stage 4 – Data Exfiltration<br>
The drive binary is responsible for exfiltrating files to Google Cloud Platform (GCP), completing the attack chain.</p>
</li>
</ul>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/diagram.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<doc-panel id="mitre-attck-tactics">
    <template #title>MITRE ATT&amp;CK Tactics</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>ATT&amp;CK Tactic</th>
<th>ATT&amp;CK Technique ID</th>
<th>Technique Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>Execution</td>
<td>T1204</td>
<td>User Execution</td>
</tr>
<tr>
<td>Persistence</td>
<td>T1543.002</td>
<td>Systemd Service</td>
</tr>
<tr>
<td>Defense Evasion</td>
<td>T1622<br>T1070.004<br>T1140</td>
<td>Debugger Evasion <br> File Deletion <br> Decode Files</td>
</tr>
<tr>
<td>Command and Control</td>
<td>T1219</td>
<td>Remote Access Tools</td>
</tr>
<tr>
<td>Exfiltration</td>
<td>T1567.002</td>
<td>Exfiltration to Cloud Storage</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<doc-anchor-target id="why-go-is-a-popular-choice-for-threat-actors">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#why-go-is-a-popular-choice-for-threat-actors">#</doc-anchor-trigger>
        <span>Why Go is a Popular Choice for Threat Actors</span>
    </h2>
</doc-anchor-target>
<hr>
<p>So, why are threat actors turning to Go? The answer is simple and lies in some of the language&#x27;s core features:</p>
<ul>
<li><p><strong>Static Linking</strong>: Go binaries are statically linked by default, which means they include all necessary dependencies. This makes the malware highly portable, as it can be run on any system without worrying about missing libraries. This also often results in a larger binary size, which can help it evade some signature-based detection systems.</p>
</li>
<li><p><strong>Native Cross-Compiling</strong>: Go&#x27;s built-in support for cross-compilation is a huge advantage. A developer can write a single codebase and easily compile it for different operating systems (like Windows, macOS, and Linux) and architectures.</p>
</li>
<li><p><strong>Ease of Use</strong>: Compared to languages like C or C++, Go is relatively easier to code.</p>
</li>
</ul>
<p>With the help of AI it is even easier to write custom malware and C2 infrastructures using go lang.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
            <h5>Note</h5>
<p>There are many resources available for detailed information on Go Lang binary internals, which you can check out here :-</p>
<p><a href="https://www.travismathison.com/posts/Golang-Reverse-Engineering-Tips/#golang-type-system" class="outbound" target="_blank"><span>Golang Reverse Engineering Tips - Travis Mathison</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a> <br>
<a href="https://cloud.google.com/blog/topics/threat-intelligence/golang-internals-symbol-recovery/" class="outbound" target="_blank"><span>Go Internals and Symbol Recovery - Google Threat Intelligence</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></p>
<p>Including all those topics would make this blog too long, so feel free to explore them separately.</p>
        </div>
    </div>
</div>
<div class="aspect-video w-full rounded-lg overflow-hidden mb-6 shadow-lg dark:shadow-lg">
    <iframe src="https://www.youtube.com/embed/mgCZJYRlHDI?t=1843s" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen class="w-full h-full"></iframe>
</div><doc-anchor-target id="analysis">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#analysis">#</doc-anchor-trigger>
        <span>Analysis</span>
    </h2>
</doc-anchor-target>
<hr>
<p>Except for the server2 payload, all other payloads were Go-based. I used the following tools to analyze them:</p>
<ul>
<li><a href="https://hex-rays.com/ida-free" class="outbound" target="_blank"><span>IDA Free</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://github.com/goretk/redress/tree/master" class="outbound" target="_blank"><span>redress</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://github.com/kevoreilly/CAPEv2" class="outbound" target="_blank"><span>CAPEv2 Sandbox</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
<li><a href="https://github.com/horsicq/Detect-It-Easy" class="outbound" target="_blank"><span>Detect-it-Easy</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a></li>
</ul>
<p>IDA Free performed better than Ghidra and Binary Ninja when decompiling Go binaries, as IDA automatically rebuilds the PCLN and recovers most of the symbols.</p>
<p>redress is an excellent tool for analyzing stripped Go binaries. It provides detailed information about Go packages and source files.</p>
<p>Finally, CAPE was used to extract C2 information from the server2 payload, as it was a MeshAgent.</p>
<doc-anchor-target id="loader-1">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#loader-1">#</doc-anchor-trigger>
        <span>Loader 1</span>
    </h3>
</doc-anchor-target>
<doc-panel id="file-details" collapsed>
    <template #title>File Details</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>Initial Loader</td>
</tr>
<tr>
<td>SHA256</td>
<td>2fb4106def39ac5bf8e20eded90d9cfbdbbb925ca3b98cde3f815ac99eaeb474</td>
</tr>
<tr>
<td>MD5</td>
<td>0ddc790155c2c844babe8ca7d500439a</td>
</tr>
<tr>
<td>Language</td>
<td>Go</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<p>The name of the file may vary depending on the delivery method used by the threat actors, so I would refer to the binary as the Initial Loader. The purpose of the Initial Loader is to deliver an encrypted second-stage component, which then downloads and executes the final C2 agent and exfiltrator payloads.</p>
<p>Using the Redress tool, we obtained a clear overview of the Go binary, including the original package name, <code translate="no" v-pre>ddns</code>. The analysis also indicated that the threat actors were building these malware payloads in a Kali VM.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_redinfo.png" alt="loader1 info" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">loader1 info</figcaption>
</figure>
</p>
<p><strong>Functions List</strong></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_redress.png" alt="loader1 source" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">loader1 source</figcaption>
</figure>
</p>
<p>The loader first checks if the system is running inside a virtual machine by calling RealCheck function. It then verifies if the internet connectivity is present through HomeChecker. If no connection is detected, a <a href="https://help.gnome.org/users/zenity/stable/index.html.oc" class="outbound" target="_blank"><span>Zenity</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a> error dialog is displayed with &quot;Boss Internet Issue&quot;.
If the loader detects VM, it self-deletes and remove all traces by calling the HiddenHome function.</p>
<p>Finally, the loader decrypts a set of encrypted URLs using the decrypt function. From these URLs, it retrieves additional stagers via the downloadFile function and executes them.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_main.png" alt="Main Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Main Function</figcaption>
</figure>
</p>
<doc-panel id="realcheck-function" collapsed>
    <template #title>RealCheck Function</template>
<p>The loader attempted to determine whether it was running inside a virtual machine by reading system files such as /sys/class/dmi. Probably the threat actors used ChatGPT or similar AI tools based on the level of plain VM checks.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_realcheck.png" alt="RealCheck Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">RealCheck Function</figcaption>
</figure>
</p>
</doc-panel>
<doc-panel id="hiddenhome-function" collapsed>
    <template #title>HiddenHome Function</template>
<p>The HiddenHome function is responsible for self-deletion. When invoked, the loader executes an rm -rf command to remove its own binary and erase traces from the system.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_hidden.png" alt="HiddenHome Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">HiddenHome Function</figcaption>
</figure>
</p>
</doc-panel>
<doc-panel id="homechecker-function" collapsed>
    <template #title>HomeChecker Function</template>
<p>The HomeChecker function verifies internet connectivity by sending a ping request to Google. If the connection check fails, the loader assumes the system is offline and halts further execution.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_homechecker.png" alt="HomeChecker Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">HomeChecker Function</figcaption>
</figure>
</p>
</doc-panel>
<doc-panel id="decrypt-function" collapsed>
    <template #title>decrypt Function</template>
<p>The decrypt function accepts three arguments: the ciphertext, the DES key, and the IV. It first decodes the ciphertext from Base64, then initializes a DES cipher in CBC mode using the provided key and IV. After decryption, the resulting plaintext is used as configuration data, such as payload download URLs.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_decrypt.png" alt="decrypt Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">decrypt Function</figcaption>
</figure>
</p>
<p>Based on the disassembly, I crafted an potential source code for the function.</p>
<div class="codeblock-wrapper"><doc-codeblock>
<pre translate="no" class="language-go"><code v-pre class="language-go">func decrypt(cipherEncoded string, keyEncoded string, ivEncoded string) {
    cipher, _ := base64.StdEncoding.DecodeString(cipherEncoded)
    key, _ := base64.StdEncoding.DecodeString(keyEncoded)
    iv, _ := base64.StdEncoding.DecodeString(ivEncoded)
    block, _ := des.NewCipher(key)
    mode := cipher.NewCBCDecrypter(block, iv)
    plain := make([]byte, len(cipher))
    mode.CryptBlocks(plain, cipher)
}</code></pre>
</doc-codeblock></div>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_cyberchef.png" alt="Decrypting the URLs using CyberChef" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Decrypting the URLs using CyberChef</figcaption>
</figure>
</p>
</doc-panel>
<p>The loader contained three encrypted strings: two corresponding to drive URLs and one serving as the password required to decrypt the inter_ddns payload.</p>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Extracted Texts</th>
</tr>
</thead>
<tbody>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=1g1AgwMnUTEV1HHmQkcH-eTww3w8et82m (access)</td>
</tr>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=1UFD10tcoPJZIBpF4hcz6orM1C57uivI7 (inter_ddns)</td>
</tr>
<tr>
<td>WOrkiNgtoDesksSS8123whyme?youseethis</td>
</tr>
</tbody>
</table>
</div>
<p>The threat actors used the email address <code translate="no" v-pre>simonedaira@gmail.com</code> to share the payloads via Google Drive. A lookup in Epieos revealed that the account had been updated only recently.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/threatintel.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>After downloading the two files, the loader decrypts the final string and uses it as an argument when executing the access binary.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_exec.png" alt="downloadFile Function - decrypting strings" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">downloadFile Function - decrypting strings</figcaption>
</figure>
</p>
<p>The loader tries to execute <code translate="no" v-pre>access</code> binary with args <code translate="no" v-pre>-f inter_ddns</code> and <code translate="no" v-pre>-d WOrkiNgtoDesksSS8123whyme?youseethis</code>.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_args.png" alt="downloadFile Function - Args" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">downloadFile Function - Args</figcaption>
</figure>
</p>
<p>After that, the loader executes the decrypted inter_ddns payload and then calls the HiddenHome function to remove all of its traces.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader1_final.png" alt="downloadFile Function - calling HiddenHome" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">downloadFile Function - calling HiddenHome</figcaption>
</figure>
</p>
<p>The remaining responsibilities are handed over to inter_ddns, but before analyzing it, let’s first examine the access binary.</p>
<doc-anchor-target id="decrypter">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#decrypter">#</doc-anchor-trigger>
        <span>Decrypter</span>
    </h3>
</doc-anchor-target>
<doc-panel id="file-details" collapsed>
    <template #title>File Details</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>access</td>
</tr>
<tr>
<td>SHA256</td>
<td>231957a5b5b834f88925a1922dba8b4238cf13b0e92c17851a83f40931f264c1</td>
</tr>
<tr>
<td>MD5</td>
<td>c1b3a940888c5677c6d9f3df7a550385</td>
</tr>
<tr>
<td>Language</td>
<td>Go</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<p>The access binary was packed with UPX and functioned as an encrypter/decrypter. It supported help argument that displayed all available options. The binary was capable of both RC4 and AES decryption.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/access_init.png" alt="access info" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">access info</figcaption>
</figure>
</p>
<p><strong>Functions List</strong></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/access_source.png" alt="access source" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">access source</figcaption>
</figure>
</p>
<p>The decrypter first calls the processFile function, which receives the provided password and file name as arguments. Depending on the selected decryption option (aes or rc4), the password is hashed using either SHA-256 (for AES) or MD5 (for RC4).
The function then reads the target file and passes the data to the processBytes function, which handles the actual decryption. Inside processBytes, execution branches to either aesDecryptEncrypt or rc4DecryptEncrypt, depending on the chosen algorithm.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/access_procfile.png" alt="processFile function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">processFile function</figcaption>
</figure>
</p>
<doc-panel id="aesdecryptencrypt-function" collapsed>
    <template #title>aesDecryptEncrypt Function</template>
<p>For AES decryption, the malware uses CTR mode. The encryption key is derived by computing the SHA-256 hash of the provided password. This derived key is then used to perform decryption on the target data.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/access_aes.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
</doc-panel>
<p>Using the password <code translate="no" v-pre>WOrkiNgtoDesksSS8123whyme?youseethis</code> we decrypted inter_ddns which was another go based binary.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/access_decrypt.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<doc-anchor-target id="loader-2">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#loader-2">#</doc-anchor-trigger>
        <span>Loader 2</span>
    </h3>
</doc-anchor-target>
<doc-panel id="file-details" collapsed>
    <template #title>File Details</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>inter_ddns</td>
</tr>
<tr>
<td>SHA256</td>
<td>38b6b93a536cbab5c289fe542656d8817d7c1217ad75c7f367b15c65d96a21d4</td>
</tr>
<tr>
<td>MD5</td>
<td>b5e8cda59477773002d80127f82d7e8b</td>
</tr>
<tr>
<td>Language</td>
<td>Go</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<p>Unlike the first loader, this second-stage loader carries broader responsibilities beyond just downloading and executing payloads. It establishes persistence on the system and deploys the final C2 agent along with the Exfiltrator payload.</p>
<p><strong>Functions List</strong></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader2_source.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>The loader begins by checking for VM artifacts. If none are found, it proceeds to download <code translate="no" v-pre>access2</code> and <code translate="no" v-pre>server2</code> via the download function. The loader then decrypts the password required by access2 to unlock server2, which is subsequently executed as the C2 agent. To maintain long-term access, the <code translate="no" v-pre>livingoftheland</code> functions establishes persistence, after which the <code translate="no" v-pre>selfdelete</code> function removes the binary to minimize forensic traces.</p>
<p>In the next stage, the loader retrieves and executes <code translate="no" v-pre>access3</code> and <code translate="no" v-pre>drive</code>. Once executed, access3 is deleted while persistence remains intact. The process concludes with the removal of the inter_ddns binary, completing the full attack cycle.</p>
<div class="flex mb-6">
    <div class="shrink-0 w-1.5 rounded-tl-lg rounded-bl-lg bg-callout-primary"></div>
    <div class="flex w-full py-4 border border-l-0 rounded-tr-lg rounded-br-lg doc-callout bg-callout-base-bg border-callout-base-border" role="alert">
        <div class="flex items-center ml-4 h-7">
            <svg xmlns="http://www.w3.org/2000/svg" class="mb-px text-callout-primary" width="22" height="22" viewBox="0 0 24 24" role="presentation">
                <g fill="currentColor"><g>
                    <path d="M12 1C5.93 1 1 5.93 1 12s4.93 11 11 11 11-4.93 11-11S18.07 1 12 1zm0 20c-4.96 0-9-4.04-9-9s4.04-9 9-9 9 4.04 9 9-4.04 9-9 9z"></path>
                    <path d="M12 11c-.55 0-1 .45-1 1v4c0 .55.45 1 1 1s1-.45 1-1v-4c0-.55-.45-1-1-1zM12.01 7c-.56 0-1 .45-1 1s.45 1 1 1 1-.45 1-1-.45-1-1-1z"></path>
                    <path fill="none" d="M0 0h24v24H0z"></path>
                </g></g>
            </svg>
        </div>
        <div class="pr-5 ml-3 w-full">
<p>The newly downloaded access binaries are essentially same as the first <code translate="no" v-pre>access</code> binary.</p>
        </div>
    </div>
</div>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader2_main.png" alt="Main function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Main function</figcaption>
</figure>
</p>
<doc-panel id="livingoftheland-function" collapsed>
    <template #title>livingoftheland Function</template>
<p>The first function, <code translate="no" v-pre>livingoftheland1</code>, establishes persistence for the <code translate="no" v-pre>server2</code> C2 agent by creating a systemd service under <code translate="no" v-pre>$HOME/.config/systemd/user/</code>. Once the service is created, it is immediately started and enabled to run on user login.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader2_persistence1.png" alt="livingoftheland1" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">livingoftheland1</figcaption>
</figure>
</p>
<p>The second function, <code translate="no" v-pre>livingoftheland2</code>, performs a similar role to the previous function. However, in this instance, it establishes persistence specifically for the <code translate="no" v-pre>drive</code> binary</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/loader2_persitence2.png" alt="livingoftheland2" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">livingoftheland2</figcaption>
</figure>
</p>
</doc-panel>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Extracted Texts</th>
</tr>
</thead>
<tbody>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=1g1AgwMnUTEV1HHmQkcH-eTww3w8et82m (access2)</td>
</tr>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=1ygXFO_RLAfvjfBS1go5qWX93o7RGLhhf (server2)</td>
</tr>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=1g1AgwMnUTEV1HHmQkcH-eTww3w8et82m (access3)</td>
</tr>
<tr>
<td>https[:]//drive.google.com/uc?export=download&amp;id=19i_DeH_tPVAeXULN0W3zDLxokoQE5UcU (drive)</td>
</tr>
</tbody>
</table>
</div>
<doc-anchor-target id="c2-agent">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#c2-agent">#</doc-anchor-trigger>
        <span>C2 Agent</span>
    </h3>
</doc-anchor-target>
<doc-panel id="file-details" collapsed>
    <template #title>File Details</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>server2</td>
</tr>
<tr>
<td>SHA256</td>
<td>05b468fc24c93885cad40ff9ecb50594faa6c2c590e75c88a5e5f54a8b696ac8</td>
</tr>
<tr>
<td>MD5</td>
<td>ddb0023ed29ffff42650cdcaeff2a663</td>
</tr>
<tr>
<td>Language</td>
<td>C</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<p>What stands out in this case is that, instead of deploying a custom C2 agent, the threat actors leveraged MeshAgent, an open-source remote management tool.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2_diec.png" alt="Detect-It-Easy" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Detect-It-Easy</figcaption>
</figure>
</p>
<p>This agent can be connected to their custom hosted MeshCentral server which allows all sort of Remote access.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2_main.png" alt="Main Function" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">Main Function</figcaption>
</figure>
</p>
<p>For simplicity, the sample was run inside the CAPE sandbox, as it didn&#x27;t had any evasion techniques and we were able to extract the C2 server information : <br> <code translate="no" v-pre>boss-servers.gov.in.indianbosssystems.ddns.net</code></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2_cape.jpg" alt="CAPE Analysis" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">CAPE Analysis</figcaption>
</figure>
</p>
<p>While checking this C2 domain we got the information about server which was hosted in AWS EC2.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2details.png" alt="C2 Server" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">C2 Server</figcaption>
</figure>
</p>
<p>Further investigation of the domain revealed that multiple domains were pointing to the same EC2 IP address: <code translate="no" v-pre>54.144.107.42</code></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2_threatintel.png" alt="C2 Domains" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">C2 Domains</figcaption>
</figure>
</p>
<p>The portal had some login page however couldn&#x27;t interact with it much.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/c2web.png" alt="C2 Portal" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption">C2 Portal</figcaption>
</figure>
</p>
<doc-anchor-target id="exfiltrator">
    <h3>
        <doc-anchor-trigger class="header-anchor-trigger" to="#exfiltrator">#</doc-anchor-trigger>
        <span>Exfiltrator</span>
    </h3>
</doc-anchor-target>
<doc-panel id="file-details" collapsed>
    <template #title>File Details</template>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Property</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>Name</td>
<td>drive</td>
</tr>
<tr>
<td>SHA256</td>
<td>a7471e871f5b23cb0de247fc4f240a88cdc4bd4069089a660cc3292f0910daa8</td>
</tr>
<tr>
<td>MD5</td>
<td>5c79a127162b9fce72947399fe56f215</td>
</tr>
<tr>
<td>Language</td>
<td>Go</td>
</tr>
</tbody>
</table>
</div>
</doc-panel>
<p>The exfiltrator had many functions for maximum data collection and leveraged a Google Cloud Platform (GCP) service account to exfiltrate data directly to Google Drive.</p>
<p>Similar to previous payloads, it performs anti-VM checks, examines os-release using the EasyFel function, and additionally collects the device&#x27;s MAC address, username, and hostname metadata.</p>
<p>It scans for all common non-zero byte files present in user local directories and mounted paths, collects the hosts file, and generates metadata for all files, which are uploaded alongside the files. It also monitors directories and mount paths for new files and repeats the exfiltration process whenever new files are found.</p>
<p><strong>Functions List</strong></p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/exfil_source.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<doc-panel id="uploadfiles-functions" collapsed>
    <template #title>UploadFiles functions</template>
<p>They check for all kind of files with the help of <code translate="no" v-pre>find</code> command and collect them from user&#x27;s home directory and local directories.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/exfil_localdir.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>It also checks for USB drives mounted on the system and exfiltrate from the drives.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/exfil_usbfiles.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
</doc-panel>
<doc-panel id="getserviceaccountjson-function" collapsed>
    <template #title>getServiceAccountJSON function</template>
<p>In this function the service account token is being decrypted.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/exfil_servicetoken.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>However, when I checked the associated service account were already deactivated or removed.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/service_token.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
<p>Finally the collected files are uploaded to drive.</p>
<p><figure class="content-center">
    <img src="../../assets/img/go_malware/exfil_drive.png" alt="" class="rounded-image-rounded border-image-border border-image-border-width" />
    <figcaption class="caption"></figcaption>
</figure>
</p>
</doc-panel>
<doc-anchor-target id="ioc-list">
    <h2>
        <doc-anchor-trigger class="header-anchor-trigger" to="#ioc-list">#</doc-anchor-trigger>
        <span>IOC List</span>
    </h2>
</doc-anchor-target>
<hr>
<div class="table-wrapper scrollbar overflow-hidden">
<table class="comfortable">
<thead>
<tr>
<th>Type</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>MD5</td>
<td>0ddc790155c2c844babe8ca7d500439a</td>
<td><code translate="no" v-pre>Initial Loader</code></td>
</tr>
<tr>
<td>MD5</td>
<td>c1b3a940888c5677c6d9f3df7a550385</td>
<td><code translate="no" v-pre>access1,2,3</code></td>
</tr>
<tr>
<td>MD5</td>
<td>7bf644d99f672f2d1c300194ba512f10</td>
<td><code translate="no" v-pre>inter_ddns</code> (encrypted)</td>
</tr>
<tr>
<td>MD5</td>
<td>b5e8cda59477773002d80127f82d7e8b</td>
<td><code translate="no" v-pre>inter_ddns</code> (decrypted)</td>
</tr>
<tr>
<td>MD5</td>
<td>4f538bda80f0e6d49e2302b941ff1d74</td>
<td><code translate="no" v-pre>server2</code> (encrypted)</td>
</tr>
<tr>
<td>MD5</td>
<td>ddb0023ed29ffff42650cdcaeff2a663</td>
<td><code translate="no" v-pre>server2</code> (decrypted)</td>
</tr>
<tr>
<td>MD5</td>
<td>fe60b38c9b873a591b3744f6f26c8982</td>
<td><code translate="no" v-pre>drive</code> (encrypted)</td>
</tr>
<tr>
<td>MD5</td>
<td>5c79a127162b9fce72947399fe56f215</td>
<td><code translate="no" v-pre>drive</code> (decrypted)</td>
</tr>
<tr>
<td>DOMAIN</td>
<td>boss-servers.gov.in.indianbosssystems.ddns.net</td>
<td>C2 Domain</td>
</tr>
<tr>
<td>IP</td>
<td>54.144.107.42</td>
<td>C2 IP</td>
</tr>
</tbody>
</table>
</div>

                                <div id="retype-tags" class="flex items-center mt-6 mb-6 clear-both">
                                    <span>
                                        <a href="../../tags/">
                                            <svg class="inline-block -mb-px mr-1.5 text-body-link hover:text-body-link-hover" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" overflow="visible" fill="currentColor"><g><path d="M21.3 9.88l-8.59-8.59C12.52 1.11 12.27 1 12 1H2c-.55 0-1 .45-1 1v10c0 .27.11.52.29.71l8.59 8.58c.57.57 1.32.88 2.12.88s1.55-.31 2.12-.88l7.17-7.17a3.009 3.009 0 00.01-4.24zm-1.42 2.82l-7.17 7.17c-.39.39-1.02.39-1.42 0L3 11.59V3h8.59l8.29 8.29c.39.39.39 1.03 0 1.41z" /><path d="M7.01 6C6.45 6 6 6.45 6 7s.45 1 1 1 1-.45 1-1-.44-1-.99-1z" /></g></svg>
                                        </a>
                                        <span class="mr-2"><a href="../../tags/malware-analysis/" class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-info-text bg-badge-info border border-badge-info-border hover:text-badge-info-text-hover hover:bg-badge-info-hover hover:border-badge-info-border-hover transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
                                    <span>malware analysis</span>
                                </a></span>
                                        <span class="mr-2"><a href="../../tags/reverse-engineering/" class="no-link inline-flex align-middle items-center justify-center font-medium leading-none whitespace-nowrap text-badge-info-text bg-badge-info border border-badge-info-border hover:text-badge-info-text-hover hover:bg-badge-info-hover hover:border-badge-info-border-hover transition-colors duration-200 ease-out h-6 px-2 text-xs rounded-md">
                                    <span>reverse engineering</span>
                                </a></span>
                                    </span>
                                </div>
                
                                <!-- Required only on API pages -->
                                <doc-toolbar-member-filter-no-results></doc-toolbar-member-filter-no-results>
                            </div>
                            <footer id="retype-content-footer" class="clear-both">
                            
                            </footer>
                        </main>
                
                        <div id="retype-page-footer" class="print:border-none border-t border-base-border pt-6 mb-8">
                            <footer class="flex flex-wrap items-center justify-between print:justify-center">
                                <div id="retype-footer-links" class="print:hidden">
                                    <ul class="flex flex-wrap items-center text-sm">
                                    </ul>
                                </div>
                                <div id="retype-copyright" class="print:justify-center py-2 text-footer-text font-footer-link text-sm leading-relaxed"><p>© 2026 - <a href="https://nxb1t.is-a.dev" class="outbound" target="_blank"><span>nxb1t.is-a.dev</span><svg xmlns="http://www.w3.org/2000/svg" class="retype-outbound-trigger docs-icon ml-1" viewBox="0 0 24 24" role="presentation"><g fill="currentColor"><path d="M15.5 2.25a.75.75 0 0 1 .75-.75h5.5a.75.75 0 0 1 .75.75v5.5a.75.75 0 0 1-1.5 0V4.06l-6.22 6.22a.75.75 0 1 1-1.06-1.06L19.94 3h-3.69a.75.75 0 0 1-.75-.75Z"/><path d="M2.5 4.25c0-.966.784-1.75 1.75-1.75h8.5a.75.75 0 0 1 0 1.5h-8.5a.25.25 0 0 0-.25.25v15.5c0 .138.112.25.25.25h15.5a.25.25 0 0 0 .25-.25v-8.5a.75.75 0 0 1 1.5 0v8.5a1.75 1.75 0 0 1-1.75 1.75H4.25a1.75 1.75 0 0 1-1.75-1.75V4.25Z"/></g></svg></a> - All rights reserved</p></div>
                            </footer>
                        </div>
                    </div>
                
                    <!-- Rendered if sidebar right is enabled -->
                    <!-- Sidebar right skeleton-->
                    <div v-cloak class="fixed top-0 bottom-0 right-0 translate-x-full bg-sidebar-right-bg border-sidebar-right-border lg:sticky lg:border-l lg:shrink-0 lg:pt-6 lg:transform-none sm:w-1/2 lg:w-64 lg:z-0 md:w-104 sidebar-right skeleton">
                        <div class="pl-5">
                            <div class="w-32 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-48 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                            <div class="w-40 h-3 mb-4 bg-skeleton-bg rounded-full loading"></div>
                        </div>
                    </div>
                
                    <!-- User should be able to hide sidebar right -->
                    <doc-sidebar-right v-cloak></doc-sidebar-right>
                </div>

            </div>
        </div>
    
        <doc-search-mobile></doc-search-mobile>
        <doc-back-to-top></doc-back-to-top>
    </div>


    <div id="retype-overlay-target"></div>

    <script data-cfasync="false">window.__DOCS__ = { "title": "Analyzing A GO Malware", level: 2, icon: "file", hasPrism: true, hasMermaid: false, hasMath: false, tocDepth: 23 }</script>
</body>
</html>
