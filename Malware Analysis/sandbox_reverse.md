---
title: Why Malware Analysis Goes Beyond Sandboxes
date: 2025-07-27
tags: ['reverse engineering', 'malware analysis']
author:
    name: nxb1t
    avatar: https://nxb1t.is-a.dev/assets/img/profile.jpeg

Category:
    - Malware Analysis
    - Reverse Engineering
---

# Why Malware Analysis Goes Beyond Sandboxes

Hi everyone!<br>
This is a short post to share a thought I had while working on a malware sample: `Should we rely only on sandboxes?`, I started thinking about this because the malware I was analyzing wasn’t detected by sandbox environments.

## The context 

I was analyzing a Linux-based GoLang binary that was designed to provide a password. Since we had sandbox environments, we simply uploaded it to see if it was safe or not.

![](/assets/img/sandbox_reverse/cape_result.png)

The results from CAPE Sandbox were clean (though it was a simple CAPE setup and required some further tuning). However, when I uploaded this binary to an **enterprise EDR** sandbox, the results were also same (treated as not suspicious), which was interesting and weird at the same time. So I was curious about this behaviour and tried manual analysis.

!!!
Just as we use sandboxes to collect IOCs, malware developers can also gather information about sandbox environments to further improve their anti-VM and anti-sandbox techniques.
!!!

## Role of Reverse Engineering

This is where reverse engineering comes into play. To start with, we don’t need to be an “ultra pro” to figure out whether a sample missed by sandbox is actually malicious. Here I won’t be including the in-depth analysis of reversing golang binaries, we can explore it in a future post.

In our case, this particular sample was stripped but not obfuscated. Just opening it in IDA and debugging it with radare2 gave a clear picture of how the sample works. Even if it had been obfuscated, we could still have identified the malicious signs. 

![IDA - Some Anti-VM Insturctions](/assets/img/sandbox_reverse/ida.png)

During the dynamic analysis, I found some urls from the sample which was not given by the sandbox environments.

![radare2 - Extracting Urls](/assets/img/sandbox_reverse/radare2.png)

Apparently, there were some authentication mechanisms for the URL that were revoked. As a result, the execution wasn't completed, which maybe a reason for  EDR sandbox to not detect anything or simply got exited due to Anti-VM techniques. However, the sandbox still failed to extract the URLs.

Thanks to reverse engineering, I was able to extract more IOCs and a better understanding of how each functions in the sample works. So, in addition to using sandboxes, we should also perform reverse engineering whenever needed to verify the results.

## Where to learn Reverse Engineering

Starting with programming fundamentals and basic assembly instructions will give you a great head start on the path to reverse engineering. And always remember one thing : `learn by doing`.

Here are some of my favourite learning sources :-<br>
[Crackme Challenges](https://crackmes.one)<br>
[Github - Awesome Reversing](https://github.com/tylerha97/awesome-reversing)<br>
[Youtube - OALabs](https://www.youtube.com/@OALABS)<br>
[Youtube - Dr Josh Stroschein](https://www.youtube.com/@jstrosch/videos)<br>
[Youtube - pwn.college](https://www.youtube.com/watch?v=o_kSgUPJk4c&list=PL-ymxv0nOtqox6nF4HXtXHnTQFGkRQU_2)<br>
